(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{320:function(t,s,n){"use strict";n.r(s);var a=n(14),e=Object(a.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("p",[t._v("首先，我们需要确保 Nginx 已经正确编译和安装，并且已启用了 "),s("code",[t._v("http_sub_module")]),t._v(" 和 "),s("code",[t._v("http_ssl_module")]),t._v(" 模块。您可以按照以下步骤进行操作：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("nginx "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-V")]),t._v("\n")])])]),s("p",[t._v("如果您看到以下输出，则表示 Nginx 已启用 "),s("code",[t._v("http_sub_module")]),t._v(" 和 "),s("code",[t._v("http_ssl_module")]),t._v(" 模块：")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("nginx version: nginx/1.14.0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Ubuntu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nbuilt with OpenSSL "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v(".1  "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("11")]),t._v(" Sep "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2018")]),t._v("\nTLS SNI support enabled\nconfigure arguments: \n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". // 其他参数\n --with-http_ssl_module \n --with-http_sub_module \n")])])]),s("p",[t._v("接下来，我们将修改 Nginx 的配置文件，以在 HTML 响应中添加自定义的 "),s("code",[t._v("JavaScript")]),t._v(" 代码。请按照以下步骤进行操作：")]),t._v(" "),s("p",[t._v("1、打开 Nginx 的配置文件。默认情况下，该文件位于 "),s("code",[t._v("/user/local/nginx/conf/nginx.conf")])]),t._v(" "),s("p",[t._v("2、在适当的位置，添加以下配置块：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("server "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9999")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location / "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        sub_filter "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'</body>'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<script>console.log(\"hello from Judith\")<\/script></body>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        sub_filter_once off"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" // 默认为 on，表示只替换第一个匹配的字符串\n        root html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        index index.html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("p",[t._v("这将在所有请求的路径下应用 "),s("code",[t._v("sub_filter")]),t._v(" 指令，并将 "),s("code",[t._v("</body>")]),t._v(" 替换为 "),s("code",[t._v('<script>console.log("hello from Judith")<\/script></body>')]),t._v("。")]),t._v(" "),s("p",[t._v("3、保存并关闭 Nginx 的配置文件")]),t._v(" "),s("p",[t._v("4、重新加载 Nginx 的配置文件")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("/user/local/nginx/sbin/nginx "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" // 配置文件语法正确\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" /user/local/nginx/sbin/nginx "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-s")]),t._v(" reload\n")])])]),s("h2",{attrs:{id:"参考链接"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://juejin.cn/post/7259650149076074556",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nginx sub_filter 来修改 html 响应内容"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://juejin.cn/s/nginx%E7%9A%84sub_filter%E7%9A%84%E4%BD%9C%E7%94%A8",target:"_blank",rel:"noopener noreferrer"}},[t._v("nginx 的 sub_filter 的作用"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);